Work in progress. Do not expect this code to work.